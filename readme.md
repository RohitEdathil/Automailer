# Automailer

Utility to send emails using an HTML template by filling it with data from a CSV file.

## Installation

- Clone the repo to a folder
- Create and activate virtual environment (Optional)
- Install dependencies by running

```
pip install -r requirements.txt
```

## Usage

---

### `config`

Configures the utility.

```
python ./app.py config
```

It will prompt you to Enter email and password.

**Only supports Gmail!!**
Make sure to [enable access](https://myaccount.google.com/lesssecureapps) to less secure apps in your Gmail account.

Credentials can be modified in `config.json` file. Which is generated by `config` command.

---

### `run`

Runs a specified job.

```
python ./app.py run JobName
```

This command checks for `template.html` and `data.csv` files in `jobs/JobName/`. And uses them as templates and data source respectively. Then sends the email after filling the template.

---

## Example

For reference, a sample job is available in the `jobs` directory called EventLink.

`jobs/EventLink/template.html`

```html
<!DOCTYPE html>
<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:v="urn:schemas-microsoft-com:vml"
  xmlns:o="urn:schemas-microsoft-com:office:office"
>
  <body>
    <h1>{{ event }}</h1>
    <p>
      Hello {{ name }},<br />
      Thank you for signing up for {{ event }}. We're really happy to have you!
      Click the link below to login to your account: <br />
      <a href="{{ link }}"> Login </a>
    </p>
  </body>
</html>
```

`jobs/EventLink/data.csv`

```
name,event,link,email,subject
Bob,IoT Workshop,#bob,testemail@rest.com,IoT Workshop Link
Alice,IoT Workshop,#alice,testemail@test.com,IoT Workshop Link
Rick,IoT Workshop,#rick,testemail@test.com,IoT Workshop Link
Sam,IoT Workshop,#sam,testemail@test.com,IoT Workshop Link
Ted,IoT Workshop,#ted,testemail@test.com,IoT Workshop Link
Dug,IoT Workshop,#dug,testemail@rest.com,IoT Workshop Link
Ken,IoT Workshop,#ken,testemail@rest.com,IoT Workshop Link

```

**Note: email and subject are mandatory fields**

The tool uses jinja2 to fill the template with data from the CSV file. So the template can be any HTML file. But it should use [jinja2 templating syntax ](https://jinja.palletsprojects.com/en/3.0.x/templates/)inorder to get expected results.

## Help

Usage can be accessed by typing

```
python ./app.py --help
```

Or

```
python ./app.py
```

Info regarding individual commands can be accessed by typing

```
python ./app.py <command> --help
```
